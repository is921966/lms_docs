# Обновление парсера Excel для оргструктуры

## Проблема
Парсер требовал строгое соответствие названий колонок и падал с ошибкой при попытке импорта файлов с немного отличающимися заголовками.

## Что было обновлено

### 1. Гибкое определение колонок
- Поддержка разных вариантов названий (например, "Наименование" и "Наименование подразделения")
- Убрана жесткая валидация через fatalError
- Добавлены понятные сообщения об отсутствующих колонках

### 2. Безопасная обработка данных
- Добавлен безопасный доступ к элементам массива через `subscript(safe:)`
- Пропуск пустых строк без ошибок
- Корректная обработка строк с неполными данными

### 3. Улучшенная логика парсинга
- Строки без табельного номера создают подразделения
- Строки с табельным номером создают сотрудников
- Автоматическое определение иерархии по кодам (АП → АП.1 → АП.1.1)

### 4. Обновленный шаблон
Шаблон теперь содержит примеры правильной структуры данных с иерархией подразделений.

## Формат данных

### Пример правильной структуры:
```
Код    | Наименование              | Таб. номер  | ФИО           | Должность
-------|---------------------------|-------------|---------------|------------------
АП     | ЦУМ                       |             |               |
АП     |                          | АР00000001  | Иванов И.И.   | Генеральный директор
АП.1   | Департамент продаж        |             |               |
АП.1   |                          | АР00000002  | Петров П.П.   | Директор департамента
АП.1.1 | Отдел розничных продаж    |             |               |
АП.1.1 |                          | АР00000003  | Сидоров С.С.  | Начальник отдела
```

## Как работает иерархия
- Парсер автоматически определяет родительское подразделение по структуре кода
- АП.1.2 → родитель АП.1
- АП.1 → родитель АП
- АП → корневое подразделение

## Статус
✅ **Обновление завершено и протестировано** 