# Реализация массовых операций (Bulk Operations)

## Обзор

Реализована функциональность массовых операций для управления несколькими курсами одновременно в рамках Фазы 2 Course Management.

## Компоненты

### 1. CourseManagementViewModel
**Файл**: `ViewModels/CourseManagementViewModel.swift`

Добавлены новые свойства и методы:

#### Свойства:
- `selectedCourseIds: Set<UUID>` - Хранит ID выбранных курсов
- `isSelectionMode: Bool` - Режим выбора активен/неактивен
- `isBulkOperationAvailable: Bool` - Вычисляемое, есть ли выбранные курсы
- `selectionCount: Int` - Количество выбранных курсов

#### Методы выбора:
- `toggleSelectionMode()` - Переключение режима выбора
- `toggleCourseSelection(_ id: UUID)` - Выбрать/снять выбор курса
- `selectAllCourses()` - Выбрать все курсы
- `deselectAllCourses()` - Снять выбор со всех

#### Массовые операции:
- `bulkDeleteSelectedCourses()` - Удалить выбранные курсы
- `bulkArchiveSelectedCourses()` - Архивировать выбранные
- `bulkPublishSelectedCourses()` - Опубликовать выбранные
- `bulkAssignSelectedCoursesToStudents(_ studentIds: [UUID])` - Назначить студентам

### 2. CourseManagementView
**Файл**: `Views/CourseManagementView.swift`

Обновлен UI для поддержки выбора:
- Кнопка "Выбрать" в toolbar для входа в режим выбора
- Checkboxes рядом с курсами в режиме выбора
- "Выбрать все" / "Отмена" в режиме выбора
- Интеграция с BulkOperationsToolbar

### 3. BulkOperationsToolbar
**Файл**: `Views/BulkOperationsToolbar.swift`

Новый компонент с панелью действий:
- Отображение количества выбранных курсов
- Кнопки действий: Удалить, Архивировать, Опубликовать, Назначить
- Подтверждение удаления через confirmationDialog
- Индикатор прогресса во время операций
- Встроенный BulkAssignView для назначения студентам

### 4. BulkAssignView
**Файл**: `Views/BulkOperationsToolbar.swift`

Модальное окно для выбора студентов:
- Поиск студентов по имени/email
- Множественный выбор через checkboxes
- Отображение количества выбранных
- Mock данные студентов для демо

## Функциональность

### Workflow массовых операций:
1. Пользователь нажимает "Выбрать" в toolbar
2. Появляются checkboxes рядом с курсами
3. Пользователь выбирает нужные курсы
4. Внизу появляется панель с действиями
5. Выбор действия выполняет операцию над всеми выбранными курсами
6. После операции выбор автоматически снимается

### Безопасность:
- Подтверждение для удаления
- Блокировка UI во время выполнения операций
- Правильная обработка ошибок
- Сообщения об успешном выполнении

## Тестирование

### Unit тесты
**Файл**: `LMSTests/Features/CourseManagement/BulkOperationsTests.swift`

Написано 16 тестов покрывающих:
- Выбор/снятие выбора курсов
- Выбрать все/снять все
- Массовое удаление
- Массовая архивация
- Массовая публикация
- Массовое назначение студентам
- Состояние UI и доступность операций
- Обработка ошибок для пустого выбора

## UI/UX особенности

1. **Визуальная обратная связь**:
   - Синие checkboxes для выбранных курсов
   - Счетчик выбранных курсов
   - Индикатор прогресса во время операций

2. **Удобство использования**:
   - "Выбрать все" для быстрого выбора
   - Горизонтальный скролл для действий
   - Иконки и подписи для ясности

3. **Безопасность**:
   - Подтверждение критичных действий
   - Блокировка во время выполнения
   - Автоматический выход из режима выбора

## Дальнейшие улучшения

1. **Фильтрация в режиме выбора**: Возможность фильтровать курсы перед массовым выбором
2. **Экспорт выбранных**: Экспорт списка выбранных курсов
3. **Шаблоны действий**: Сохранение часто используемых комбинаций действий
4. **Undo операций**: Возможность отменить последнее массовое действие

---

**Sprint 47, День 152**  
**Статус**: ✅ Реализовано  
**TDD**: ✅ Соблюден (16 тестов) 