# –°—Ç–∞—Ç—É—Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—Ä–∞—à–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –Ω–æ–≤–æ—Å—Ç–µ–π –≤ –ª–µ–Ω—Ç–µ

**–î–∞—Ç–∞**: 22 –∏—é–ª—è 2025  
**Sprint**: 52, –î–µ–Ω—å 170  
**–í—Ä–µ–º—è**: 16:15

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –Ω–æ–≤–æ—Å—Ç—å –≤ –ª–µ–Ω—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫—Ä–∞—à–∏–ª–æ—Å—å —Å –æ—à–∏–±–∫–æ–π:
```
Exception NSException * "Invalid type in JSON write (__NSConcreteUUID)"
```

## üîç –ê–Ω–∞–ª–∏–∑

–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ `ComprehensiveLogger` –∫–æ—Ç–æ—Ä—ã–π –ø—ã—Ç–∞–ª—Å—è —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ JSON –æ–±—ä–µ–∫—Ç—ã —Ç–∏–ø–∞ `UUID`, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è `JSONSerialization`.

–°—Ç–µ–∫ –≤—ã–∑–æ–≤–∞:
```
objc_exception_throw
_writeJSONValue
_writeJSONObject
ComprehensiveLogger.writeToFile(_:)
ComprehensiveLogger.addLog(_:)
```

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

–£–ª—É—á—à–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `sanitizeForJSON` –≤ `ComprehensiveLogger.swift`:

```swift
private func sanitizeForJSON(_ value: Any) -> Any {
    if let date = value as? Date {
        return ISO8601DateFormatter().string(from: date)
    } else if let uuid = value as? UUID {
        return uuid.uuidString  // ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è UUID
    } else if let url = value as? URL {
        return url.absoluteString  // ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è URL
    } else if let dict = value as? [String: Any] {
        return dict.mapValues { sanitizeForJSON($0) }
    } else if let array = value as? [Any] {
        return array.map { sanitizeForJSON($0) }
    } else if let data = value as? Data {
        return data.base64EncodedString()  // ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Data
    } else if value is NSNull {
        return NSNull()
    } else if JSONSerialization.isValidJSONObject([value]) {
        return value
    } else {
        // Convert any non-JSON-serializable object to string
        return String(describing: value)  // ‚Üê Fallback –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Ç–∏–ø–æ–≤
    }
}
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏**:
   - –í—Å–µ —Å–ª–æ–∂–Ω—ã–µ —Ç–∏–ø—ã (UUID, Date, URL, Data) –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è
   - JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ö–æ–¥–∏—Ç —É—Å–ø–µ—à–Ω–æ

2. **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –≤ —Å–∏–º—É–ª—è—Ç–æ—Ä–µ**:
   - PID: 44217
   - –ö—Ä–∞—à –±–æ–ª—å—à–µ –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞**
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±–æ–ª—å—à–µ –Ω–µ –∫—Ä–∞—à–∏—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –Ω–æ–≤–æ—Å—Ç–µ–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é
- –í—Å–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–µ—Ä–∏–∞–ª–∏–∑—É—é—Ç—Å—è –≤ JSON

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. –°–æ–∑–¥–∞—Ç—å TestFlight build 2.4.1 —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º
2. –î–æ–±–∞–≤–∏—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è `ComprehensiveLogger`
3. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –∫–æ–¥–µ –∫–∞–∫–∏–µ —Ç–∏–ø—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## üì± –°—Ç–∞—Ç—É—Å

**–ì–û–¢–û–í–û –ö –†–ï–õ–ò–ó–£** - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –±–∞–≥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç. 