# LMS Sprint 41 Day 186 (16.01.2025) - Backend API Integration & Real Push Service

## üìÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–Ω–µ
- **–ù–æ–º–µ—Ä –¥–Ω—è**: 186
- **–î–∞—Ç–∞**: 16.01.2025
- **–°–ø—Ä–∏–Ω—Ç**: 41 (Notifications & Push Module)

## üéØ –¶–µ–ª–∏ –¥–Ω—è
1. –°–æ–∑–¥–∞—Ç—å API endpoints –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å backend –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –≤ NotificationService
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π push notification —Å–µ—Ä–≤–∏—Å
4. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
5. E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## üìã –ü–ª–∞–Ω –∑–∞–¥–∞—á

### 1. API Endpoints (Backend)
- [ ] GET /api/notifications - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- [ ] GET /api/notifications/:id - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] POST /api/notifications - —Å–æ–∑–¥–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] PUT /api/notifications/:id/read - –ø–æ–º–µ—Ç–∫–∞ –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω–æ–µ
- [ ] DELETE /api/notifications/:id - —É–¥–∞–ª–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] GET /api/notifications/preferences - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- [ ] PUT /api/notifications/preferences - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- [ ] POST /api/push-tokens - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è push —Ç–æ–∫–µ–Ω–∞

### 2. Backend Service Integration
- [ ] –°–æ–∑–¥–∞—Ç—å NotificationAPIService
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã API –≤—ã–∑–æ–≤–æ–≤
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å NotificationService
- [ ] –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ —Å–µ—Ç–∏
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### 3. Real Push Notification Service
- [ ] –°–æ–∑–¥–∞—Ç—å APNsPushNotificationService
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é APNs
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É —á–µ—Ä–µ–∑ UNUserNotificationCenter
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ rich notifications
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ notification extensions

### 4. Database Migrations
- [ ] –¢–∞–±–ª–∏—Ü–∞ notifications
- [ ] –¢–∞–±–ª–∏—Ü–∞ notification_preferences
- [ ] –¢–∞–±–ª–∏—Ü–∞ push_tokens
- [ ] –¢–∞–±–ª–∏—Ü–∞ notification_events
- [ ] –ò–Ω–¥–µ–∫—Å—ã –∏ constraints

### 5. E2E Testing
- [ ] –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ API
- [ ] –¢–µ—Å—Ç –ø–æ–ª—É—á–µ–Ω–∏—è push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- [ ] –¢–µ—Å—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º
- [ ] –¢–µ—Å—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- [ ] –¢–µ—Å—Ç quiet hours

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### API Specifications
```yaml
/api/notifications:
  GET:
    parameters:
      - page: int
      - limit: int
      - filter: NotificationFilter
    response: PaginatedResponse<Notification>
  
  POST:
    body: CreateNotificationRequest
    response: Notification

/api/notifications/{id}:
  GET:
    response: Notification
  
  DELETE:
    response: 204 No Content

/api/notifications/{id}/read:
  PUT:
    response: Notification

/api/push-tokens:
  POST:
    body: RegisterPushTokenRequest
    response: PushToken
```

### Database Schema
```sql
CREATE TABLE notifications (
    id UUID PRIMARY KEY,
    user_id UUID NOT NULL,
    type VARCHAR(50) NOT NULL,
    title VARCHAR(255) NOT NULL,
    body TEXT,
    data JSONB,
    channels TEXT[],
    priority INTEGER,
    is_read BOOLEAN DEFAULT FALSE,
    read_at TIMESTAMP,
    created_at TIMESTAMP DEFAULT NOW(),
    expires_at TIMESTAMP,
    metadata JSONB
);

CREATE TABLE push_tokens (
    id UUID PRIMARY KEY,
    user_id UUID NOT NULL,
    token VARCHAR(255) NOT NULL,
    device_id VARCHAR(255) NOT NULL,
    platform VARCHAR(20),
    environment VARCHAR(20),
    is_active BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT NOW(),
    last_used_at TIMESTAMP
);
```

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
- –í—Å–µ API endpoints —Ä–∞–±–æ—Ç–∞—é—Ç –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å backend –∑–∞–≤–µ—Ä—à–µ–Ω–∞
- Push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏—Ö–æ–¥—è—Ç –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- E2E —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API –æ–±–Ω–æ–≤–ª–µ–Ω–∞

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –º–æ–¥—É–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Å backend –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –∏ —Ä–µ–∞–ª—å–Ω—ã–º–∏ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏. 